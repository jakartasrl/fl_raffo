function afterProcessFinish(processId){			var fecha = new Date();	var dateParser = new java.text.SimpleDateFormat("yyyy-MM-dd");	hAPI.setCardValue("fechaFinSolicitud", dateParser.format(fecha));	hAPI.setCardValue("horaFinSolicitud", fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds());	var userId = getValue("WKUser");	var companyId = getValue("WKCompany");	var nroSolicitudPadre = hAPI.getCardValue("padre_nroSolicitud");	var nroSolicitud = hAPI.getCardValue("aten_nroSolicitud");		var c1 = DatasetFactory.createConstraint("metadata#active", "true", "true", ConstraintType.MUST); 	var c2 = DatasetFactory.createConstraint("padre_nroSolicitud", nroSolicitudPadre, nroSolicitudPadre, ConstraintType.MUST); 	var c3 = DatasetFactory.createConstraint("aten_nroSolicitud", nroSolicitud, nroSolicitud, ConstraintType.MUST_NOT); 	var datasetAtenciones = DatasetFactory.getDataset("raf-atencion-consultas", null, [c1,c2,c3], null); 		for(j = 0; j < datasetAtenciones.rowsCount; j++) { 		if((datasetAtenciones.getValue(j, "tarea") != "CONSULTA CERRADA" ) && (datasetAtenciones.getValue(j, "tarea") != "CONSULTA CANCELADA")){			return;			}	}		var tareasRAF03 = {			REGISTRAR_CONSULTA : 9,				MODIFICAR_CONSULTA : 10,			VERIF_CONSULTA_CERRADA : 8	}		try {		var arq = arqLoadLib(["com.arquimeda.fluig.js.ws.BPM-v1","com.arquimeda.fluig.js.Properties-v1"]);		arq.prop.load({			datasetName: "parametros"		});		var cardData = arq.bpm.getCardData(nroSolicitudPadre);		cardData.cerrarConsulta = "1";				var ret = arq.bpm.saveAndSendTask({			username: arq.prop.get("RAF03.usuarioSistema.login"),			password: arq.prop.get("RAF03.usuarioSistema.pass"),			companyId: getValue("WKCompany"),			processInstanceId: nroSolicitudPadre,			choosedState: tareasRAF03.VERIF_CONSULTA_CERRADA,			colleagueIds: ["System:Auto"],			comments: "Tarea de Registro de Consulta movida automaticamente nro: "+nroSolicitudPadre,			userId: arq.prop.get("RAF03.usuarioSistema.id"),			completeTask: true, 			attachments: [],	        cardData: cardData,	        managerMode: true,	        workflowServiceName: "ECMWorkflowEngineService",	        log: 1,		});			} catch(e) {		log.info("########## Error saveAndSendTask: " + e);		throw "Se produjo un error al finalizar la solicitud desde AtenciÃ³n de Consultas. Por favor, consulte con el administrador del sistema.";	}	}//arqLoadLib - v1.0function arqLoadLib(e){var t={};if(e==null){return t}var n=function(e,t){for(var n=0;n<e.length;n++){if(e[n]==t)return true}return false};var r=DatasetFactory.getDataset("arq_libreriaJS",null,null,null);for(var i=0;i<r.rowsCount;i++){var s=r.getValue(i,"lib");if(n(e,s)){var o=r.getValue(i,"src");var u=r.getValue(i,"name");try{var a=new Function("lib","return "+o);t[u]=a(t)}catch(f){log.error("*** Error compilando libreria "+s+":"+f)}}}return t}